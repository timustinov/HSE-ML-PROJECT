# **Анализ и прогнозирование потребления алкоголя студентами**

## **1. Цель проекта**
Разработать модель машинного обучения для прогнозирования высокого уровня потребления алкоголя студентами на основе социально-демографических, академических и поведенческих данных. Модель предназначена для выявления групп риска и поддержки профилактических мер в образовательных учреждениях.

## **2. Данные и предобработка**
- **Источник:** Набор данных "Student Alcohol Consumption" с HuggingFace Datasets (португальские школы).
- **Объём:** 395 студентов, 33 признака.
- **Целевая переменная:** Бинарный признак `high_alcohol` (высокое потребление = 1, низкое = 0), созданный на основе суммы ежедневного (`Dalc`) и выходного (`Walc`) потребления (порог ≥ 6).
- **Баланс классов:** Несбалансированные (примерно 11% — высокое потребление).
- **Признаки:** Отобраны 22 наиболее релевантных признака (демографические, академические, социальные, поведенческие).
- **Препроцессинг:** Label Encoding для категориальных признаков, масштабирование числовых, разделение на train/test (80/20) с сохранением баланса.

## **3. Используемые модели**
Были протестированы 5 алгоритмов:
1. **Logistic Regression** (базовый линейный метод)
2. **Random Forest** (ансамблевый метод на деревьях)
3. **Gradient Boosting** (бустинг деревьев)
4. **SVM** (метод опорных векторов)
5. **KNN** (k-ближайших соседей)

Все модели обучены с учётом дисбаланса (`class_weight='balanced'` где возможно).

## **4. Метрики оценки**
Использовались:
- **Accuracy** (общая точность)
- **Precision** (точность положительного класса)
- **Recall** (полнота положительного класса)
- **F1-Score** (гармоническое среднее)
- **ROC-AUC** (площадь под ROC-кривой)
- **Матрица ошибок, Precision-Recall кривая**

## **5. Результаты**
### **Лучшая модель: Random Forest**
На тестовой выборке показала следующие результаты:

| Метрика         | Значение |
|----------------|----------|
| **Accuracy**   | 0.93     |
| **Precision**  | 0.93     |
| **Recall**     | 0.67     |
| **F1-Score**   | 0.78     |
| **ROC-AUC**    | 0.94     |

### **Интерпретация результатов (Random Forest):**
- **Accuracy 93%** — модель хорошо разделяет классы в целом.
- **Precision 93%** — из всех предсказанных "высоким потреблением" 93% действительно им являются (низкий уровень ложных срабатываний).
- **Recall 67%** — модель находит 67% реальных случаев высокого потребления (пропускает около 33%).
- **F1-Score 0.78** — хороший баланс между точностью и полнотой, особенно с учётом дисбаланса классов.
- **ROC-AUC 0.94** — отличная способность модели различать классы.

### **Матрица ошибок (Random Forest):**
```
              Предсказано
              Низкое   Высокое
Истинно
Низкое         168       2
Высокое        13       26
```
- **Ложные срабатывания (FP):** 2 случая
- **Пропущенные случаи (FN):** 13 случаев

## **6. Важные признаки (по Random Forest)**
Наиболее значимые факторы для прогнозирования высокого потребления алкоголя:
1. **Выходные привычки (`goout`)** — частота выходов в общественные места.
2. **Возраст (`age`)** — старшие студенты склонны к большему потреблению.
4. **Время с друзьями (`freetime`)** — социальная активность.
5. **Академические неудачи (`failures`)** — корреляция с проблемным поведением.

## **7. Практические выводы**
- Модель **Random Forest** готова к применению для скрининга студентов группы риска.
- Наиболее уязвимая группа: **старшие студенты (16–18 лет) с высокой социальной активностью и академическими трудностями**.
- Рекомендуется фокусировать профилактические меры на студентах с комбинацией факторов: частые выходы, много свободного времени, низкая успеваемость.
- Модель имеет высокую точность (93%), но **чувствительность 67%** означает, что каждый третий случай высокого потребления может быть пропущен — требуется дополнительный мониторинг.

## **8. Ограничения и рекомендации**
### **Ограничения:**
- Небольшой размер выборки (395 записей).
- Данные только из Португалии — возможны культурные особенности.
- Дисбаланс классов (11% положительных случаев).

### **Рекомендации:**
1. Увеличить выборку и собрать данные из разных регионов.
2. Применить методы борьбы с дисбалансом (SMOTE, oversampling).
3. Добавить социально-экономические признаки (доход семьи, занятость родителей).
4. Протестировать более сложные ансамблевые методы (CatBoost, LightGBM).
5. Внедрить модель в пилотном режиме в учебных заведениях с последующей валидацией.

## **9. Заключение**
Проект успешно разработал и протестировал модель **Random Forest**, которая с высокой точностью (93%) и хорошим балансом метрик (F1=0.78, AUC=0.94) прогнозирует уровень потребления алкоголя студентами. Модель сохраняет интерпретируемость и указывает на ключевые факторы риска, что делает её полезным инструментом для профилактической работы в образовательных учреждениях.
